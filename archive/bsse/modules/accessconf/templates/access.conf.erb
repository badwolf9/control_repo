#
# This file was autogenerated on <%= File.mtime("#{file}").strftime("%m/%d/%Y %T %Z") %> # by puppet <%= @puppetversion %>
# It can still be managed manually but will be overwritten on the next run.
# SVN <%= %x(svn info #{file} | grep Revision | tr -d "\n")%>
#
#
#	Allow selected bsse groups and root from everywhere if in ou-service-user-login
#
<% if classes.include?("ou_service_user_login") -%>
<% @my_groups.each do |g| %>+ : @<%= g %>-user : ALL
<% end -%>
<% end -%>
+ : @itsc-user : ALL
#
#	Default users
#
+ : root : ALL
+ : localuser : ALL
<% if @operatingsystem =~ /RedHat|CentOS/ && @lsbmajdistrelease =~ /6|7/ %>
+ : gdm : :0 :1 :2
<% end -%>
+ : nx : ALL
#	Allow crontabs for (service) users 
+ : ALL : cron crond
#
#	Other users
#
<% if classes.include?("service_db_postgresql") -%>
+ : postgres : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-dsvr79/ -%>#	web server for borgwardt group
+ : damianr : ALL
+ : placzekc : ALL
+ : mafox : ALL
+ : dogrimm : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-licsvr03/ -%>#	License server runs as vlsi
+ : vlsi : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-tay01|bs-ssgate02/ -%># User for rsyncing Tay data to US
+ : tayproxy : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-svn01|bs-svn03|bs-svn04/ -%>#	Special users for Git and Subversion
+ : gitcisd svnitsc svncisd svnborgwardt svnhima svnbewi svnstel svniber svncina svnkhammash svnparo anttil : ALL
<% end -%>
<% if scope.lookupvar("::hostname") == "/bs-ci01|bs-ci03/" -%>#	Special users for bs-ci01 and bs-ci03
+ : ci : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-gpu01|bs-gpu02|cina-dw02|bs-cina02|cina-gpu01/ -%># Guest users from CINA group
+ : @shared-guests-user : ALL
<% end -%>
<% if scope.lookupvar("::hostname") == "bs-gpu03" -%># FMI user from CINA group
+ : retina1 : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-dsvr02|bs-smsvr01/ -%>#	User nagios needs access from the nagios server
+ : nagios : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-hierlemann/ -%># Urs Frey needs access for Dessign_Kits folder. Refer Yihui Chen
+ : ufrey : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-camerasvr01/ -%>#	Camera FTP users
+ : camera01 camera02 camera04 camera05 camera06 camera07 : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-openbis14/ -%>#	Oracle Database user
+ : oracle : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-openbis18/ -%>#	Openbis grid user
+ : openbisgrid : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-otrs/ -%>#	OTRS user
+ : otrs : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-git01/ -%>#	Git users
+ : git-ro git : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-stadler02|bs-git02/ -%>#	Git users
+ : git : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-nagios0?/ -%># nagios users on monitoring systems
+ : nagios : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-ftpsvr01/ -%># External ftp users
+ : (sftp-user) : ALL
<% end -%>
<% if classes.include?("service-atlassian") -%># Users for atlassian
+ : confluen : ALL
+ : jira : ALL
+ : crowd : ALL
+ : xwiki : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /^bs-jira02|bs-wiki03/ -%>#	Backup Jira needs jira
+ : confluen : ALL
+ : jira : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-dsvr34/ -%>#	Archiver runs cron jobs on bs-dsv34
+ : bs-archiver : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /^bs-jpk/ -%>#		JPK stuff
+ : jpkroot : ALL
+ : jpkuser : ALL
+ : localadmin : ALL
+ : service : ALL
<% end -%>
<% if scope.lookupvar("::hostname") =~ /bs-hpws09/ -%>#
+ : rolandd : ALL
+ : placzekc : ALL
<% end -%>
#	Disallow the rest
- : ALL EXCEPT root : ALL

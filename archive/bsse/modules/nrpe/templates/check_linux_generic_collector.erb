#!/usr/bin/perl
#
# This file was autogenerated on <%= File.mtime(@file).strftime("%m/%d/%Y %T %Z") %> by puppet <%= puppetversion %>
# It can still be managed manually but will be overwritten on the next run.
# SVN <%= %x(svn info #{file} | grep Revision | tr -d "\n")%>
#
#
use strict;

my $lvl=0;
my $maxlvl=0;
my $fh;
my %logs;
my $collectorLog="/var/log/nagios-collector.log";

sub dieOpening
{
	print "Could not open $collectorLog. ($!)";
	exit(2);
}

if(-f "$collectorLog"){
{
	open($fh,"<$collectorLog") or &dieOpening;
	while(<$fh>){
		my ($lvl,$file,$log)= split /:/;
		$logs{$lvl}=$logs{$lvl}.$log;
		if($lvl > $maxlvl && $lvl != 3) { $maxlvl = $lvl;}
		}
	print $logs{$maxlvl};
	exit($maxlvl);	
	}
} else {
	print "OK\n";
	exit(0);
}
